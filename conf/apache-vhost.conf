<VirtualHost *:80>
    ServerName swimwithjj.com
    ServerAlias *.swimwithjj.com
    RewriteEngine on
    RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R,L]
</VirtualHost>

<VirtualHost *:443>
    ServerAdmin admin@swimwithjj.com
    ServerName www.swimwithjj.com
    ServerAlias swimwithjj.com *.swimwithjj.com

    SSLEngine on
	SSLCertificateFile /etc/letsencrypt/live/swimwithjj.com/cert.pem
	SSLCertificateKeyFile /etc/letsencrypt/live/swimwithjj.com/privkey.pem
	SSLCertificateChainFile /etc/letsencrypt/live/swimwithjj.com/chain.pem

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}.html -f
    RewriteRule ^(.+)$ $1.html [L,QSA]

    # 301 from swimwithjj.com/page.html to swimwithjj.com/page
    RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /.*\.html\ HTTP/
    RewriteRule ^(.*)\.html$ /$1 [R=301,L]

    DocumentRoot /var/www/www.swimwithjj.com/
    <Directory /var/www/www.swimwithjj.com/>
        Options ExecCGI MultiViews
        AddHandler cgi-script .cgi
    </Directory>

    <Directory /var/www/www.swimwithjj.com/admin>
        Options ExecCGI
        AddHandler cgi-script .cgi
        AuthType Basic
        AuthName "Restricted Access"
        AuthUserFile /etc/apache2/htpasswd
        Require valid-user
    </Directory>

    ErrorLog /var/log/apache2/www.swimwithjj.com-error.log
    CustomLog /var/log/apache2/www.swimwithjj.com-access.log combined
    LogLevel warn

</VirtualHost>

