<!DOCTYPE html>
<html ng-app="payByCardApp" ng-controller="mainController">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>SwimWithJJ - Credit Card Payment</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <img src="./img/underwater_crop.jpg" hidden/>
    <style>
        body {
            padding-top: 0px !important;
        }
        [ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak {
            display: none;
        }
    </style>
    <link href="./css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="./css/style.css" rel="stylesheet">
    <script src="js/modernizr-2.6.2-respond-1.1.0.min.js"></script>
  </head>

  <body ng-cloak>
    <!--[if lt IE 7]>
        <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->


    <div id="sign-up" class="section-header">
        <div class="container">
            <h1>SwimWithJJ <small>Credit Card Payment</small></h1>
        </div>
    </div>
    <section class="container">
        <div class="pagenav nav-up"><a href="."><i class="icon-arrow-left"></i> Back to Homepage</a></div>

        <p class="lead">You may use this form to pay for your scheduled lessons with a credit card. If you prefer to pay by cash or check, please see the instructions provided in your lesson times confirmation email.</p>

        <div ng-hide="paymentInfo">
            loading payment information <img src="img/spinner.gif" />
        </div>

        <div class="alert alert-error" ng-show="paymentInfo.error">
            <h4>Could not access information</h4>
            <p>Your information could not be retrieved. If you believe you've received this message in error, please contact JJ by using the form on the homepage at <a href=".">www.swimwithjj.com</a>.</p>
        </div>

        <div class="alert alert-info" ng-show="paymentInfo.cardSaved">
            <h4>Payment Information Already Entered</h4>
            <p>Your credit card payment information has already been provided. If you have any questions, please contact JJ by using the form on the homepage at <a href=".">www.swimwithjj.com</a>.</p>
        </div>

        <form class="form-horizontal" id="paybycard-form" ng-show="paymentInfo && !paymentInfo.cardSaved && !paymentInfo.error && !cardAdded">

            <fieldset>
                <div class="pad10">
                    <span class="lead">Number of Sessions: </span><span class="lead">{{paymentInfo.sessionCount}}</span>
                </div>

                <div class="pad10">
                    <h4>Credit Card</h4>
                    <p>Your total includes a credit card processing fee of 2.9% + 30 cents.</p>
                    <div class="pad10">
                        <span class="lead">Total: </span><span class="lead">{{creditTotal() | currency}}</span>
                    </div>
                </div>
            </fieldset>

            <div class="alert alert-block alert-error" ng-show="paymentError">
                <h4>Sorry</h4>
                <p>There seems to be a problem saving your payment information. Below is the error received by the processing company:</p>
                <p>{{paymentError}}</p>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-large btn-primary"
                    ng-hide="savingPaymentInfo" ng-click="payWithCard()">Pay with Card</button>
            </div>

            <div class="alert alert-info" ng-show="savingPaymentInfo">
                Saving Payment Information <img src="img/spinner.gif" />
            </div>

        </form>

        <div class="alert alert-block alert-success" ng-show="cardAdded">
            <h4>Thank You!</h4>
            Your payment information has been updated. You will receive a confirmation email when your card is charged. If you have any questions or concerns, please use the contact form on the homepage at <a href=".">www.swimwithjj.com</a>.
        </div>

    </section> 

    <hr>

    <footer>
        <p><small>SwimWithJJ 2013<small></p>
    </footer>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.5/angular.min.js"></script> 
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.5/angular-sanitize.min.js"></script> 
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.0/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.0.0/moment.min.js"></script>
    <script src="https://checkout.stripe.com/v2/checkout.js"></script>
    <script src="./js/paybycard.js"></script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-15537987-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </body>
</html>
